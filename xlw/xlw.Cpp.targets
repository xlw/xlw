<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003" ToolsVersion="16.0">

  <Target Name="XLWCheck" BeforeTargets="PrepareForBuild">
    <Error   Condition=" '$(ConfigurationType)' != 'DynamicLibrary' " Text="PROJECT TYPE MUST BE DynamicLibrary (dll) NOT $(ConfigurationType) " /> 
  </Target>


  <Target Name="BeforeClean">
    <Message Text="Deleting @(XLWInterface->'%(RelativeDir)_xlw%(Filename).cpp')" Importance="high"/>
    <Delete Files="@(XLWInterface->'%(RelativeDir)_xlwAutoGenerated\_xlw%(Filename).cpp')"/>
  </Target>

  <Target Name="XLWGenerateInterface" BeforeTargets="PrepareForBuild" Inputs="%(XLWInterface.Identity)" Outputs="@(XLWInterface->'%(RelativeDir)_xlwAutoGenerated\_xlw%(Filename).cpp')">
    <MakeDir  Directories="%(XLWInterface.RelativeDir)_xlwAutoGenerated"/>
    <Message Text="Generating from interface  [%(XLWInterface.Identity)]  boilerplate source file  [ %(XLWInterface.RelativeDir)_xlwAutoGenerated\_xlw%(XLWInterface.Filename).cpp]" Importance="high"/>
    <Exec Command="$(_XLW2704_)native\lib\InterfaceGenerator.exe  %(XLWInterface.Identity)  %(XLWInterface.RelativeDir)_xlwAutoGenerated\_xlw%(XLWInterface.Filename).cpp">
      <Output TaskParameter="ExitCode" PropertyName="ErrorCode"/>
    </Exec>
    <ItemGroup>
      <ClCompile Include="%(XLWInterface.RelativeDir)_xlwAutoGenerated\_xlw%(XLWInterface.Filename).cpp" />
    </ItemGroup>
  </Target>

</Project>